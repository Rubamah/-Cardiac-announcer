<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<title>Cardiac Announcer</title>
<meta name="viewport" content="width=device-width,initial-scale=1" />
<style>
  body {
    margin:0;
    background:#f8fafc;
    font-family:"Segoe UI",Tahoma,Arial,sans-serif;
    color:#0f172a;
    display:flex;
    align-items:center;
    justify-content:center;
    height:100vh;
    flex-direction:column;
  }
  h1 {
    font-size:clamp(60px,12vw,120px);
    margin:0;
  }
  h2 {
    font-size:clamp(28px,5vw,48px);
    margin:10px 0 0;
    color:#334155;
  }
</style>

<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
</head>
<body>
  <h1 id="num">-</h1>
  <h2 id="win"></h2>

<script>
(function(){
  const cfg={
    apiKey:"AIzaSyCWWnMsge75Q3_MDF9Aj9wo4C5KD6RVGfw",
    authDomain:"q-matic-b7d77.firebaseapp.com",
    databaseURL:"https://q-matic-b7d77-default-rtdb.firebaseio.com",
    projectId:"q-matic-b7d77",
    storageBucket:"q-matic-b7d77.appspot.com",
    messagingSenderId:"908187704899",
    appId:"1:908187704899:web:b8bcf33cda90bafe81bef6"
  };
  firebase.initializeApp(cfg);
  const db=firebase.database();
  const ROOT="cardiac_demo";

  const numEl=document.getElementById("num");
  const winEl=document.getElementById("win");

  let lastNum=null;

  db.ref(`${ROOT}/latest`).on("value", snap=>{
    const v=snap.val();
    if(!v) return;

    const n=v.number, w=v.window;
    if(n===lastNum) return; // منع التكرار
    lastNum=n;

    numEl.textContent = n || "-";
    winEl.textContent = w ? `شباك ${w}` : "";

    // تشغيل الصوت
    const phrase = w 
      ? `تذكرة رقم ${n}، الرجاء التوجه إلى شباك ${w}`
      : `تذكرة رقم ${n}`;
    const u = new SpeechSynthesisUtterance(phrase);
    u.lang = "ar-SA";
    u.rate = 0.9;
